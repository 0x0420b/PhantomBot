(function(){var e=0,l=0,o=false,s=false,a=$.inidb.exists("settings","followReward")?parseInt($.inidb.get("settings","followReward")):100;followMessage=$.inidb.exists("settings","followMessage")?$.inidb.get("settings","followMessage"):$.lang.get("followhandler.follow.message");function n(){if(a>0){if($.systemTime()-e>65e3){s=false;if(l==3){$.say($.lang.get("followhandler.followtrain.triple"))}else if(l==4){$.say($.lang.get("followhandler.followtrain.quad"))}else if(l==5){$.say($.lang.get("followhandler.followtrain.penta"))}else if(l>5&&l<=10){$.say($.lang.get("followhandler.followtrain.mega",l))}else if(l>10&&l<=20){$.say($.lang.get("followhandler.followtrain.ultra",l))}else if(l>20){$.say($.lang.get("followhandler.followtrain.unbelievable",l))}}else{l=1}}e=$.systemTime()}$.bind("twitchFollowsInitialized",function(){if(!$.bot.isModuleEnabled("./handlers/followHandler.js")){return}$.consoleLn($.lang.get("followhandler.anouncements.enabled"));o=true});$.bind("twitchFollow",function(e){var r=e.getFollower();r=$.username.resolve(r),followmsg=followMessage;if(!$.inidb.exists("followed",r)&&$.bot.isModuleEnabled("./handlers/followHandler.js")){if(a>0){$.inidb.incr("points",r.toLowerCase(),a)}if(o){followmsg=followmsg.replace("(name)",r);followmsg=followmsg.replace("(reward)",a);$.say(followmsg)}$.inidb.set("followed",r,true);$.writeToFile($.username.resolve(r),"./addons/followHandler/latestFollower.txt",false);l+=1;if(!s){var t=setTimeout(function(){n()},15e3);s=true}}});$.bind("twitchFollow",function(e){if(!$.bot.isModuleEnabled("./handlers/followHandler.js")){return}var l=e.getFollower().toLowerCase();if($.inidb.exists("followed",l)){return}if($.bot.isModuleEnabled("./commands/lastseenCommand.js")){$.inidb.set("lastseen",l,$.systemTime())}if(a>0){$.inidb.incr("points",l,a)}if(o){if(a>0){$.say($.lang.get("followhandler.new.follow",$.username.resolve(l),$.getPointsString(a)))}else{$.say($.lang.get("followhandler.new.follow.noreward",$.username.resolve(l)))}}$.setIniDbBoolean("followed",l,true);$.writeToFile($.username.resolve(l),"./addons/followHandler/latestFollower.txt",false);n()});$.bind("twitchUnfollow",function(e){if(!$.bot.isModuleEnabled("./handlers/followHandler.js")){return}var l=e.getFollows().toLowerCase(),o=$.getIniDbBoolean("followed",l);if(o){$.setIniDbBoolean("followed",l,false)}});$.bind("command",function(e){var l=e.getSender().toLowerCase(),o=e.getCommand(),s=e.getArgs(),n=e.getArguments();comArg=s[0];if(o.equalsIgnoreCase("followreward")){comArg=parseInt(comArg);if(!comArg||isNaN(comArg)){$.say($.whisperPrefix(l)+$.lang.get("followhandler.set.followreward.usage",$.pointNameMultiple))}a=comArg;$.inidb.set("settings","followReward",a);$.say($.whisperPrefix(l)+$.lang.get("followhandler.set.followreward.success",$.getPointsString(a)))}if(o.equalsIgnoreCase("followmessage")){if(!comArg||isNaN(comArg)){$.say($.whisperPrefix(l)+$.lang.get("followhandler.set.followmessage.usage"))}followMessage=n;$.inidb.set("settings","followMessage",followMessage);$.say($.whisperPrefix(l)+$.lang.get("followhandler.set.followmessage.success"))}if(o.equalsIgnoreCase("followers")){$.say($.lang.get("followhandler.followers",$.getFollows($.channelName)))}if(o.equalsIgnoreCase("checkfollow")){comArg=comArg.toLowerCase();if(!comArg||comArg==""){$.say($.whisperPrefix(l)+$.lang.get("followhandler.check.usage"));return}if($.user.isFollower(comArg)){$.say($.lang.get("followhandler.check.follows",$.username.resolve(comArg)))}else{$.say($.lang.get("followhandler.check.notfollows",$.username.resolve(comArg)))}}});$.bind("initReady",function(){if($.bot.isModuleEnabled("./handlers/followHandler.js")){$.registerChatCommand("./handlers/followHandler.js","followreward",1);$.registerChatCommand("./handlers/followHandler.js","followmessage",1);$.registerChatCommand("./handlers/followHandler.js","checkfollow",2);$.registerChatCommand("./handlers/followHandler.js","followers",7)}})})();