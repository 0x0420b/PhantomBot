(function(){var e=$.inidb.exists("greeting","autoGreetEnabled")?$.getIniDbBoolean("greeting","autoGreetEnabled"):false,i=$.inidb.exists("greeting","defaultJoin")?$.inidb.get("greeting","defaultJoin"):"",s=216e5;$.bind("ircChannelJoin",function(t){if($.isOnline($.channelName)){var n=t.getUser().toLowerCase(),g=$.resolveRank(n),r=$.inidb.exists("greeting",n)?$.inidb.get("greeting",n):"",a=$.inidb.exists("greetingCoolDown",n)?parseInt($.inidb.get("greetingCoolDown",n)):0,o=$.systemTime();if(r&&a+s<o){$.say(r);$.inidb.set("greetingCoolDown",n,o)}else if(e){$.say(i.replace("(name)",g))}}});$.bind("command",function(i){var s=i.getSender().toLowerCase(),t=i.getCommand(),n=i.getArgs(),g=n[0],r;if(t.equalsIgnoreCase("greeting")){if(!g){if($.isAdmin(s)){$.say($.whisperPrefix(s)+$.lang.get("greetingsystem.generalusage.admin"))}else{$.say($.whisperPrefix(s)+$.lang.get("greetingsystem.generalusage.other"))}return}if(g.equalsIgnoreCase("toggledefault")){if(!$.isModv3(s,i.getTags())){$.say($.whisperPrefix(s)+$.modMsg);return}e=!e;$.setIniDbBoolean("greeting","autoGreetEnabled",e);if(e){$.say($.whisperPrefix(s)+$.lang.get("greetingsystem.set.autogreet.enabled",$.username.resolve($.botName)))}else{$.say($.whisperPrefix(s)+$.lang.get("greetingsystem.set.autogreet.disabled",$.username.resolve($.botName)))}}if(g.equalsIgnoreCase("setdefault")){r=n.splice(1,n.length-1).join(" ");if(!$.isModv3(s,i.getTags())){$.say($.whisperPrefix(s)+$.modMsg);return}if(!r){$.say($.whisperPrefix(s)+$.lang.get("greetingsystem.set.autogreet.usage"));return}if(r.indexOf("(name)")<0){$.say($.whisperPrefix(s)+$.lang.get("greetingsystem.set.autogreet.noname"));return}$.inidb.set("greeting","defaultJoin",r);$.say($.whisperPrefix(s)+$.lang.get("greetingsystem.set.autogreet.success",r,e?$.lang.get("common.enabled"):$.lang.get("common.disabled")))}if(g.equalsIgnoreCase("enable")){r=n.splice(1,n.length-1).join(" ");if(!r){$.say($.whisperPrefix(s)+$.lang.get("greetingsystem.generalusage.other"));return}$.inidb.set("greeting",s,r);$.say($.whisperPrefix(s)+$.lang.get("greetingsystem.set.personal.success",r))}if(g.equalsIgnoreCase("disable")){if($.inidb.exists("greeting",s)){$.inidb.del("greeting",s);$.say($.whisperPrefix(s)+$.lang.get("greetingsystem.remove.personal.success"))}}}});$.bind("initReady",function(){if($.bot.isModuleEnabled("./systems/greetingSystem.js")){$.registerChatCommand("./systems/greetingSystem.js","greeting",6)}})})();