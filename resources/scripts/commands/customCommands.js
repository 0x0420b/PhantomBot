!function(){function e(e,s){e=e.toLowerCase(),s=s.toLowerCase(),$.inidb.exists("pricecom",s)&&parseInt($.inidb.get("pricecom",s))>0&&($.isMod(e)||($.inidb.incr("points",e,$.inidb.get("pricecom",s)),$.inidb.SaveAll()))}function s(e,s,a,i){var r;if(e+="",a)for(r in a){var m=new RegExp("/"+a[r].replace(/([\-\[\]\/\{\}\(\)\*\+\?\.\\\^\$\|])/g,"\\$&")+"/","ig");e=e.replace(m,i[r])}return e.replace(/\([.]{3}\)/g,1==s.getArgs().length?$.username.resolve(s.getArgs()[0]):s.getArguments()).replace(/\(sender\)/g,$.resolveRank(s.getSender().toLowerCase())).replace(/\(baresender\)/g,$.username.resolve(s.getSender().toLowerCase())).replace(/\(random\)/g,$.username.resolve($.randElement($.users)[0])).replace(/\(pointsname\)/g,$.pointNameMultiple)}function a(e,s){return $.isAdmin(e)?!0:$.getCommandGroup(s)>=$.getUserGroupId(e)}function i(e){return parseInt($.inidb.exists("pricecom",e)?$.inidb.get("pricecom",e):0)}function r(){var e,s=$.inidb.GetKeyList("command","");for(e in s)$.commandExists(s[e])||$.registerChatCommand("./commands/customCommands.js",s[e],$.inidb.exists("permcom",s[e])?parseInt($.inidb.get("permcom",s[e])):7)}function m(){var e,s,a=$.inidb.GetKeyList("aliases","");for(s in a)$.commandExists(a[s])||(e=$.inidb.get("aliases",a[s]),$.registerChatCommand("./commands/customCommands.js",a[s],$.getCommandGroup(e)))}$.bind("command",function(e){var a,i,r,o,n=e.getSender().toLowerCase(),t=$.username.resolve(n,e.getTags()),d=e.getCommand(),c=e.getArgs(),g=e.getArguments();if(d.equalsIgnoreCase("addcom")){if(!$.isModv3(n,e.getTags()))return void $.say($.whisperPrefix(n)+$.modMsg);if(a=(c[0]+"").replace(/^!/,"").toLowerCase(),i=g.substr(a.length).trim(),$.commandExists(a)||0==a.length||0==i.length)return void $.say($.whisperPrefix(n)+$.lang.get("customcommands.add.error",t));$.registerChatCommand("./commands/customCommands.js",a),$.inidb.set("command",a,i),$.logEvent("customCommands.js",50,t+' created command "!'+a+'" with message "'+i+'"'),$.say($.whisperPrefix(n)+$.lang.get("customcommands.add.success",t,a))}if(d.equalsIgnoreCase("delcom")){if(!$.isModv3(n,e.getTags()))return void $.say($.whisperPrefix(n)+$.modMsg);if(a=(c[0]+"").replace(/^!/,"").toLowerCase(),r=$.inidb.GetKeyList("aliases",""),0==a.length)return void $.say($.whisperPrefix(n)+$.lang.get("customcommands.delete.usage"));if(!$.commandExists(a))return void $.say($.whisperPrefix(n)+$.lang.get("cmd.404",a));for(o in r)$.inidb.get("aliases",r[o]).equalsIgnoreCase(a)&&($.unregisterChatCommand(r[o]),$.inidb.del("aliases",r[o]));$.unregisterChatCommand(a),$.inidb.del("command",a),$.inidb.del("permcom",a),$.say($.whisperPrefix(n)+$.lang.get("customcommands.delete.success",t,a))}if(d.equalsIgnoreCase("aliascom")){if(!$.isModv3(n,e.getTags()))return void $.say($.whisperPrefix(n)+$.modMsg);if(a=c[0].replace("!","").toLowerCase(),i=c[1].replace("!","").toLowerCase(),a&&i||$.say($.whisperPrefix(n)+$.lang.get("customcommands.alias.usage")),!$.commandExists(a))return void $.say($.whisperPrefix(n)+$.lang.get("customcommands.alias.error.target404",t));if($.inidb.exists("aliases",a))return void $.say($.whisperPrefix(n)+$.lang.get("customcommands.alias.error",t));$.inidb.set("aliases",i,a),$.registerChatCommand("./commands/customCommands.js",i),$.logEvent("customCommands.js",59,t+' added alias "!'+i+'" for "!'+a+'"'),$.say($.whisperPrefix(n)+$.lang.get("customcommands.alias.success",t,a,i))}if(d.equalsIgnoreCase("delalias")){if(!$.isModv3(n,e.getTags()))return void $.say($.whisperPrefix(n)+$.modMsg);if(a=(c[0]+"").replace(/^!(.*)/,"$1").toLowerCase(),!a)return void $.say($.whisperPrefix(n)+$.lang.get("customcommands.alias.delete.usage"));if(!$.inidb.exists("alias",a))return void $.say($.whisperPrefix(n)+$.lang.get("customcommands.alias.delete.error.alias.404",t));$.unregisterChatCommand(a),$.inidb.del("aliases",a),$.logEvent("customCommands.js",56,t+" deleted alias !"+a),$.say($.whisperPrefix(n)+$.lang.get("customcommands.delete.success",t,a))}if(d.equalsIgnoreCase("permcom")){var l;if(!$.isAdmin(n))return void $.say($.whisperPrefix(n)+$.adminMsg);if(a=(c[0]+"").replace(/^!(.*)/,"$1").toLowerCase(),l=c[1]+"",!a||!l)return void $.say($.whisperPrefix(n)+$.lang.get("customcommands.set.perm.usage"));isNaN(parseInt(l))&&(l=$.getGroupIdByName(l)),$.inidb.set("permcom",a,l),$.say($.whisperPrefix(n)+$.lang.get("customcommands.set.perm.success",a,$.getGroupNameById(l)))}if(d.equalsIgnoreCase("pricecom")){if(!$.isAdmin(n))return void $.say($.whisperPrefix(n)+$.adminMsg);if(a=(c[0]+"").replace(/^!(.*)/,"$1").toLowerCase(),i=c[1],!a||!i)return void $.say($.whisperPrefix(n)+$.lang.get("customcommands.set.price.usage"));if(!$.commandExists(a))return void $.say($.whisperPrefix(n)+$.lang.get("customcommands.set.price.error.404"));if(isNaN(parseInt(i))||parseInt(i)<0)return void $.say($.whisperPrefix(n)+$.lang.get("customcommands.set.price.error.invalid"));$.inidb.set("pricecom",a,i),r=$.inidb.GetKeyList("aliases","");for(o in r)for(o in r)$.inidb.get("aliases",r[o]).equalsIgnoreCase(a)&&$.inidb.set("pricecom",r[o],i);$.say($.whisperPrefix(n)+$.lang.get("customcommands.set.price.success",a,i,$.pointNameMultiple))}$.inidb.exists("command",d.toLowerCase())&&(i=$.inidb.get("command",d.toLowerCase()),$.say(s(i,e))),m()}),$.bind("initReady",function(){$.bot.isModuleEnabled("./commands/customCommands.js")&&(r(),m(),$.registerChatCommand("./commands/customCommands.js","addcom",2),$.registerChatCommand("./commands/customCommands.js","pricecom",2),$.registerChatCommand("./commands/customCommands.js","aliascom",2),$.registerChatCommand("./commands/customCommands.js","delalias",2),$.registerChatCommand("./commands/customCommands.js","delcom",2),$.registerChatCommand("./commands/customCommands.js","permcom",1))}),$.returnCommandCost=e,$.replaceCommandTags=s,$.permCom=a,$.getCommandPrice=i}();
